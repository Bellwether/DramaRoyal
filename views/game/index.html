<section id="game-lobby">
  <div id='lobby-wrapper'>	
	<div id='lobby-chat-panel'>
	  <h2>Homeroom <span id='player-count'>(0)</span></h2>
      <div id='lobby-chat'></div>
	</div>
	
    <div id='games-panel'>	
	  <% var cnt = 0; for(var k in locals.games) {cnt=cnt+1}; %>

      <h2>Dramas <span id='game-count'>(<%- cnt %>)</span></h2>
      <ul id='game-list'>
        <% for(var k in locals.games) { %>
          <li id="game-<%- locals.games[k]._id %>" class='lobby-game'>
	        <h5><%- locals.games[k].title %></h5>
		    <ul>
			  <% for(var i = 0; i < locals.games[k].players.length; i++) { %>	
			    <li id="<%- 'game-'+locals.games[k]._id+'-player-'+locals.games[k].players[i].userId %>"><%- locals.games[k].players[i].name %> </li>
			  <% } %>	
		    </ul>
	        <%- (locals.games[k].status === 'pending') ? "<a href='/games/"+locals.games[k]._id+"'>[join drama]</a>" : "(Fighting!)" %>
          </li>	
        <% } %>	
      </ul>
    </div>	

  </div>

  <div id='chat-controls'>
	<%- partial('game/ui/lobby_console') %>
  </div>

  <div id='lobby-dashboard'>
	<div id='lobby-users'></div>
  </div>

</section>

<script type="text/javascript">
  $(document).ready(function() {
	Lobby.listen('<%- sessionId %>');
  });
</script>